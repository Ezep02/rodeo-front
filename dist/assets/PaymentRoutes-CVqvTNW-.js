import{A as N,r as n,j as e,u as y,B as x,G as w,R as v,a as h,N as b}from"./index-AL-VPenz.js";import{C as D,a as C,b as R,c as T}from"./card-DXiLM1pq.js";import{D as k}from"./download-A2dJciCb.js";import{A as S}from"./arrow-left-T6lrj-kS.js";const A="http://localhost:9090/api/v1/mercado_pago",E=async a=>(await N.get(`${A}/${a}`)).data.slot,L=({date:a,time:t})=>{const[o,c]=n.useState({days:0,hours:0,minutes:0,seconds:0});return n.useEffect(()=>{if(!a||!t)return;const r=()=>{const i=new Date(a),[u,m]=t.split(":").map(Number);i.setHours(u,m,0,0);const l=new Date,s=i.getTime()-l.getTime();if(s>0){const f=Math.floor(s/864e5),j=Math.floor(s%(1e3*60*60*24)/(1e3*60*60)),p=Math.floor(s%(1e3*60*60)/(1e3*60)),g=Math.floor(s%(1e3*60)/1e3);c({days:f,hours:j,minutes:p,seconds:g})}else c({days:0,hours:0,minutes:0,seconds:0})};r();const d=setInterval(r,1e3);return()=>clearInterval(d)},[t,a]),e.jsxs("div",{className:"",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-800 mb-2",children:"Tiempo restante"}),e.jsx("div",{className:"bg-gray-900 rounded-xl p-6 text-white",children:e.jsx("div",{className:"grid grid-cols-4 gap-4 text-center",children:["days","hours","minutes","seconds"].map(r=>e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:String(o[r]).padStart(2,"0")}),e.jsx("div",{className:"text-xs text-gray-300 capitalize",children:r})]},r))})})]})},M=()=>{const{token:a}=y(),[t,o]=n.useState(null),[c,r,d]=n.useActionState(async(u,m)=>{var l;try{const s=await E(m.slice(6));return o(s),null}catch(s){return console.error(s),((l=s==null?void 0:s.response)==null?void 0:l.data)||"Error de autenticación"}},null);if(n.useEffect(()=>{a&&n.startTransition(()=>{r(a)})},[a]),d)return e.jsxs("div",{className:"h-screen flex items-center justify-center flex-col gap-2",children:[e.jsx("div",{className:"loader mb-2"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Recuperando datos..."})]});if(c||!t)return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center px-4 text-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Sesión expirada o datos no disponibles"}),e.jsx(x,{className:"bg-black text-white hover:bg-gray-800",onClick:()=>window.location.href="/",children:"Volver al inicio"})]});const i=new Date(t.date).toLocaleDateString("es-AR",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:e.jsxs(D,{className:"w-full max-w-md mx-auto bg-white shadow-xl rounded-2xl",children:[e.jsxs(C,{className:"text-center pb-4",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"w-16 h-16 flex items-center justify-center",children:e.jsx(w,{size:30,className:"text-rose-500"})})}),e.jsx(R,{className:"text-xl font-bold text-gray-900",children:"¡Cita Confirmada!"}),e.jsx("p",{className:"text-gray-600 text-sm mt-2",children:"Su cita ha sido reservada con éxito."})]}),e.jsxs(T,{className:"space-y-6",children:[e.jsx(L,{date:t.date,time:t.time}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Fecha de cita"}),e.jsx("span",{className:"font-medium",children:i})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Hora"}),e.jsx("span",{className:"font-medium",children:t.time})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{className:"w-full bg-black hover:bg-gray-800 text-white",onClick:()=>window.print(),children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Descargar comprobante"]}),e.jsxs(x,{variant:"outline",className:"w-full",onClick:()=>window.location.href="/",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Volver al inicio"]})]})]})]})})},_=()=>e.jsxs(v,{children:[e.jsx(h,{path:"/success/:token",element:e.jsx(M,{})}),e.jsx(h,{path:"*",element:e.jsx(b,{to:"/",replace:!0})})]});export{_ as default};
