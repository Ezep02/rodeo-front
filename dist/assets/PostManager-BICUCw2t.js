import{c as K,j as e,G as D,B as o,d as V,r as t,F as W,H as Q,I as X,J as Y,K as Z,M as $,E as k}from"./index-AL-VPenz.js";import{C as ee,u as se}from"./usePost-DEX7Fghh.js";import{C as E,a as I,b as T,c as M,d as F}from"./card-DXiLM1pq.js";import{B as L}from"./badge-DCrQblHJ.js";import{A as le,a as re,T as ae,b as ie,c as te,d as ce,e as ne,f as oe,g as de,h as me,P as xe}from"./alert-dialog-DWojgdsi.js";import{C as O}from"./calendar-D5FUtbTF.js";import{S as he,u as ue,C as je}from"./useCloudinary-B1GQUtJG.js";import{a as ge}from"./index-CYxorXPt.js";import{U as S}from"./cloudinary-0XirjNsb.js";import{C as pe}from"./index-CNfnnRa4.js";import{S as fe}from"./SuccessAlert-CesVCbMF.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=K("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]),Ne=({post_data:s,handleEdit:a,handleDelete:l})=>e.jsxs(E,{className:"overflow-hidden",children:[s.preview_url&&e.jsx("div",{className:"aspect-video overflow-hidden",children:s.preview_url!=""?e.jsx("img",{src:s.preview_url,alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(D,{size:54,className:"text-rose-500"})})}),e.jsx(I,{className:"pb-3",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-lg leading-tight",children:s.title}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(L,{variant:s.is_published?"default":"secondary",children:s.is_published?"Published":"Draft"})})]})})}),e.jsxs(M,{className:"pt-0",children:[e.jsx(F,{className:"line-clamp-2 mb-4",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(O,{className:"w-4 h-4 mr-1"}),new Date(s.created_at).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(o,{size:"sm",variant:"ghost",onClick:()=>a(s),children:e.jsx(he,{className:"w-4 h-4"})}),e.jsxs(le,{children:[e.jsx(re,{asChild:!0,children:e.jsx(o,{size:"sm",variant:"ghost",children:e.jsx(ae,{className:"w-4 h-4"})})}),e.jsxs(ie,{children:[e.jsxs(te,{children:[e.jsx(ce,{children:"Eliminar Post"}),e.jsxs(ne,{children:['Estas segudo de querer eliminar "',s.title,'"?. Esta accion no se puede deshacer.']})]}),e.jsxs(oe,{children:[e.jsx(de,{children:"Cancel"}),e.jsx(me,{onClick:()=>l(s.id),children:"Delete"})]})]})]})]})]})]})]},s.id),be=({title:s,description:a,imageUrl:l})=>e.jsxs(E,{className:"overflow-hidden shadow-md border border-zinc-200",children:[l&&e.jsx("div",{className:"aspect-video overflow-hidden bg-zinc-100",children:l!==""?e.jsx("img",{src:l,alt:s,className:"w-full h-full object-cover"}):e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(D,{size:54,className:"text-rose-500"})})}),e.jsx(I,{className:"pb-3",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-lg leading-tight",children:s}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(L,{children:"Publicado"})})]})}),e.jsxs(M,{className:"pt-0",children:[e.jsx(F,{className:"line-clamp-2 mb-4",children:a}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(O,{className:"w-4 h-4 mr-1"}),new Date().toLocaleDateString("es-AR",{day:"numeric",month:"short",year:"numeric"})]})]})]}),we=({onClose:s,mode:a="create",initialData:l,onEditSubmit:c,open:m})=>{const n=a==="edit",{register:u,handleSubmit:f,watch:j,reset:x}=V(),{cloudImgGallery:v,FetchMoreImg:N,cloudNextCursor:b}=ue(),[w,h]=t.useState(!1),[g,r]=t.useState(!1),[i,y]=t.useState();t.useEffect(()=>{n&&l&&(x({title:l.title,description:l.description}),l.preview_url&&y({secure_url:l.preview_url}))},[n,l,x]);const q=()=>r(d=>!d),G=d=>{y(d),r(!1)},H=j("title"),B=j("description"),[U,_,R]=t.useActionState(async(d,C)=>{var A,P;if(!(i!=null&&i.secure_url)){console.warn("Debe seleccionar una imagen.");return}const z={title:C.title,description:C.description,preview_url:i.secure_url};try{n&&l&&c?await c({...l,...z}):await ee(z)&&(h(!0),x(),y(void 0))}catch(p){return h(!0),((P=(A=p==null?void 0:p.response)==null?void 0:A.data)==null?void 0:P.error)||"Error creando el post"}},void 0),J=d=>{t.startTransition(()=>{_(d)})};return e.jsx(W,{open:m,onOpenChange:s,children:e.jsxs(Q,{className:` \r
                        2xl:max-h-[90vh] 2xl:min-h-[80vh] 2xl:max-w-5xl\r
                        xl:max-h-[90vh] xl:min-h-[80vh] xl:max-w-4xl \r
                        lg:max-h-[90vh] lg:min-h-[85vh] lg:max-w-3xl\r
                        md:max-h-[95vh] md:min-h-[80vh] md:max-w-2xl  \r
                        max-w-full max-h-full\r
                        w-full h-full \r
                        p-6 flex flex-col bg-zinc-50 z-50 md:rounded-3xl\r
                        shadow-2xl slide-in-right overflow-hidden overflow-y-scroll scroll-abrir-editar-tarjeta`,style:{animation:"slide-in 0.3s ease-out"},children:[e.jsx(X,{className:"mb-6 pt-2",children:e.jsxs("div",{className:"flex items-start flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{className:"p-2 rounded-full bg-stone-100 hover:bg-stone-200 transition",onClick:s,children:e.jsx(Y,{size:18,className:"text-zinc-700"})}),e.jsx("h1",{className:"text-lg font-semibold text-zinc-700",children:n?"Editar post":"Nuevo post"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-zinc-900 rounded-xl text-white",children:e.jsx(ge,{size:24})}),e.jsxs("div",{children:[e.jsx(Z,{className:"text-lg text-start font-semibold text-zinc-700",children:"Comparte con los clientes"}),e.jsx($,{className:"text-start",children:"Agrega imágenes, crea descripciones llamativas y publica contenido. Ideal para mostrar cortes, logros y novedades."})]})]})]})}),e.jsx(k,{message:U,show:w,onClose:()=>h(!1)}),g?e.jsx(je,{img:v,onClose:q,onSelect:G,fetchMoreImg:N,nextCursor:b}):e.jsxs("form",{onSubmit:f(J),className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-zinc-700",children:"Título"}),e.jsx("input",{...u("title",{required:!0}),placeholder:"Título del post",className:"w-full p-3 border border-zinc-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-zinc-700",children:"Descripción"}),e.jsx("textarea",{...u("description",{required:!0}),placeholder:"Escribe el contenido...",className:"w-full p-3 border border-zinc-300 rounded-md resize-none min-h-[120px]"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-zinc-700",children:"Imagen del post"}),e.jsx("p",{className:"text-sm text-zinc-500 mb-2",children:"Selecciona la imagen que se mostrará en la publicación"})]}),e.jsx("div",{className:"rounded-lg border border-zinc-200 p-4 space-y-4",children:i?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:i.secure_url,alt:"Seleccionada",className:"w-28 h-20 object-cover rounded-md border"}),e.jsx(o,{size:"sm",onClick:()=>r(!0),children:"Cambiar imagen"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-zinc-500 mb-2",children:"Vista previa del post:"}),e.jsx(be,{title:H,description:B,imageUrl:i.secure_url})]})]}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-zinc-500",children:"No hay imagen seleccionada"}),e.jsx(o,{onClick:()=>r(!0),size:"sm",children:"Agregar imagen"})]})})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(o,{type:"button",variant:"ghost",onClick:s,children:"Cancelar"}),e.jsx(o,{type:"submit",children:n?g?"Guardando...":e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Guardar cambios"]}):e.jsx(e.Fragment,{children:R?e.jsx("div",{children:e.jsx(ve,{})}):e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Publicar post"]})})})]})]})]})})},Me=()=>{const[s,a]=t.useState(!1),[l,c]=t.useState(null),{post:m,DeletePost:n,showPostAlert:u,onSuccessMsg:f,setShowPostAlert:j,capturedErr:x,isOnErrAlert:v,setOnErrAlert:N,UpdatePost:b}=se(),w=()=>{c(null),a(r=>!r)},h=r=>{c(r),a(!0)},g=async r=>{b(r),c(null),a(!1)};return e.jsxs("div",{className:"flex flex-grow",children:[e.jsx(we,{mode:l?"edit":"create",initialData:l??void 0,onClose:()=>{c(null),a(!1)},open:s,onEditSubmit:g}),e.jsx(fe,{message:f,show:u,onClose:()=>j(!1)}),e.jsx(k,{message:x,show:v,onClose:()=>N(!1)}),e.jsxs("div",{className:"w-full",children:[e.jsxs("header",{className:"flex items-start gap-3 pt-4 pb-6 flex-wrap justify-between",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"p-2 bg-zinc-900 rounded-lg shadow-sm",children:e.jsx(pe,{size:24,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-gray-800 text-sm font-semibold",children:"Últimos Posts"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Gestiona tus publicaciones recientes"})]})]}),e.jsx("div",{className:"",children:e.jsxs(o,{size:"sm",onClick:w,className:"bg-zinc-800 text-white hover:bg-zinc-700",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Nuevo post"]})})]}),Array.isArray(m)&&m.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-2 w-full",children:m.map((r,i)=>e.jsx(Ne,{post_data:r,handleDelete:n,handleEdit:h},i))}):e.jsx("div",{className:"flex justify-center",children:e.jsx("p",{children:"Al parecer no hay publicaciones recientes."})})]})]})};export{Me as default};
