import{b as x,m as se,r as y,A as k,n as Ce,j as n,C as Q,o as Z,p as ee,q as te,d as he,k as N,T as _e,f as Ne,g as oe,h as le,e as Pe}from"./index-Dnxtm2pS.js";import{i as Se,D as Te,b as De,E as Oe,c as X,d as V,e as ke,A as Le,h as F,j as Ee,k as re,l as Re,L as Me,m as me,u as Ie,G as $e,n as ce,g as Be,X as fe,Y as Fe,f as ze,C as Ge,a as Ye,o as qe,p as We}from"./chart-ChxBofpR.js";import{B as Ke}from"./button-ujtkwOP2.js";var Ve=["type","layout","connectNulls","ref"],He=["key"];function O(e){"@babel/helpers - typeof";return O=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(e)}function ue(e,t){if(e==null)return{};var r=Ue(e,t),a,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)a=o[i],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function Ue(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function Y(){return Y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Y.apply(this,arguments)}function de(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?de(Object(r),!0).forEach(function(a){A(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function D(e){return Ze(e)||Qe(e)||Je(e)||Xe()}function Xe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Je(e,t){if(e){if(typeof e=="string")return ae(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ae(e,t)}}function Qe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ze(e){if(Array.isArray(e))return ae(e)}function ae(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function et(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pe(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,ye(a.key),a)}}function tt(e,t,r){return t&&pe(e.prototype,t),r&&pe(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rt(e,t,r){return t=H(t),at(e,ve()?Reflect.construct(t,r||[],H(e).constructor):t.apply(e,r))}function at(e,t){if(t&&(O(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nt(e)}function nt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ve=function(){return!!e})()}function H(e){return H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},H(e)}function it(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ne(e,t)}function ne(e,t){return ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,i){return a.__proto__=i,a},ne(e,t)}function A(e,t,r){return t=ye(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ye(e){var t=st(e,"string");return O(t)=="symbol"?t:t+""}function st(e,t){if(O(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(O(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var q=function(e){function t(){var r;et(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return r=rt(this,t,[].concat(i)),A(r,"state",{isAnimationFinished:!0,totalLength:0}),A(r,"generateSimpleStrokeDasharray",function(s,l){return"".concat(l,"px ").concat(s-l,"px")}),A(r,"getStrokeDasharray",function(s,l,u){var h=u.reduce(function(w,_){return w+_});if(!h)return r.generateSimpleStrokeDasharray(l,s);for(var m=Math.floor(s/h),f=s%h,d=l-s,c=[],p=0,v=0;p<u.length;v+=u[p],++p)if(v+u[p]>f){c=[].concat(D(u.slice(0,p)),[f-v]);break}var j=c.length%2===0?[0,d]:[d];return[].concat(D(t.repeat(u,m)),D(c),j).map(function(w){return"".concat(w,"px")}).join(", ")}),A(r,"id",Ie("recharts-line-")),A(r,"pathRef",function(s){r.mainCurve=s}),A(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),A(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return it(t,e),tt(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var a=this.getTotalLength();this.setState({totalLength:a})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var a=this.getTotalLength();a!==this.state.totalLength&&this.setState({totalLength:a})}}},{key:"getTotalLength",value:function(){var a=this.mainCurve;try{return a&&a.getTotalLength&&a.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(a,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,s=o.points,l=o.xAxis,u=o.yAxis,h=o.layout,m=o.children,f=De(m,Oe);if(!f)return null;var d=function(v,j){return{x:v.x,y:v.y,value:v.value,errorVal:me(v.payload,j)}},c={clipPath:a?"url(#clipPath-".concat(i,")"):null};return x.createElement(X,c,f.map(function(p){return x.cloneElement(p,{key:"bar-".concat(p.props.dataKey),data:s,xAxis:l,yAxis:u,layout:h,dataPointFormatter:d})}))}},{key:"renderDots",value:function(a,i,o){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var l=this.props,u=l.dot,h=l.points,m=l.dataKey,f=V(this.props,!1),d=V(u,!0),c=h.map(function(v,j){var w=b(b(b({key:"dot-".concat(j),r:3},f),d),{},{value:v.value,dataKey:m,cx:v.x,cy:v.y,index:j,payload:v.payload});return t.renderDotItem(u,w)}),p={clipPath:a?"url(#clipPath-".concat(i?"":"dots-").concat(o,")"):null};return x.createElement(X,Y({className:"recharts-line-dots",key:"dots"},p),c)}},{key:"renderCurveStatically",value:function(a,i,o,s){var l=this.props,u=l.type,h=l.layout,m=l.connectNulls;l.ref;var f=ue(l,Ve),d=b(b(b({},V(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(o,")"):null,points:a},s),{},{type:u,layout:h,connectNulls:m});return x.createElement(ke,Y({},d,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(a,i){var o=this,s=this.props,l=s.points,u=s.strokeDasharray,h=s.isAnimationActive,m=s.animationBegin,f=s.animationDuration,d=s.animationEasing,c=s.animationId,p=s.animateNewValues,v=s.width,j=s.height,w=this.state,_=w.prevPoints,E=w.totalLength;return x.createElement(Le,{begin:m,duration:f,isActive:h,easing:d,from:{t:0},to:{t:1},key:"line-".concat(c),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(S){var C=S.t;if(_){var R=_.length/l.length,P=l.map(function(g,U){var $=Math.floor(U*R);if(_[$]){var B=_[$],T=F(B.x,g.x),je=F(B.y,g.y);return b(b({},g),{},{x:T(C),y:je(C)})}if(p){var Ae=F(v*2,g.x),we=F(j/2,g.y);return b(b({},g),{},{x:Ae(C),y:we(C)})}return b(b({},g),{},{x:g.x,y:g.y})});return o.renderCurveStatically(P,a,i)}var W=F(0,E),M=W(C),I;if(u){var K="".concat(u).split(/[,\s]+/gim).map(function(g){return parseFloat(g)});I=o.getStrokeDasharray(M,E,K)}else I=o.generateSimpleStrokeDasharray(E,M);return o.renderCurveStatically(l,a,i,{strokeDasharray:I})})}},{key:"renderCurve",value:function(a,i){var o=this.props,s=o.points,l=o.isAnimationActive,u=this.state,h=u.prevPoints,m=u.totalLength;return l&&s&&s.length&&(!h&&m>0||!Ee(h,s))?this.renderCurveWithAnimation(a,i):this.renderCurveStatically(s,a,i)}},{key:"render",value:function(){var a,i=this.props,o=i.hide,s=i.dot,l=i.points,u=i.className,h=i.xAxis,m=i.yAxis,f=i.top,d=i.left,c=i.width,p=i.height,v=i.isAnimationActive,j=i.id;if(o||!l||!l.length)return null;var w=this.state.isAnimationFinished,_=l.length===1,E=se("recharts-line",u),S=h&&h.allowDataOverflow,C=m&&m.allowDataOverflow,R=S||C,P=re(j)?this.id:j,W=(a=V(s,!1))!==null&&a!==void 0?a:{r:3,strokeWidth:2},M=W.r,I=M===void 0?3:M,K=W.strokeWidth,g=K===void 0?2:K,U=Re(s)?s:{},$=U.clipDot,B=$===void 0?!0:$,T=I*2+g;return x.createElement(X,{className:E},S||C?x.createElement("defs",null,x.createElement("clipPath",{id:"clipPath-".concat(P)},x.createElement("rect",{x:S?d:d-c/2,y:C?f:f-p/2,width:S?c:c*2,height:C?p:p*2})),!B&&x.createElement("clipPath",{id:"clipPath-dots-".concat(P)},x.createElement("rect",{x:d-T/2,y:f-T/2,width:c+T,height:p+T}))):null,!_&&this.renderCurve(R,P),this.renderErrorBar(R,P),(_||s)&&this.renderDots(R,B,P),(!v||w)&&Me.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(a,i){return a.animationId!==i.prevAnimationId?{prevAnimationId:a.animationId,curPoints:a.points,prevPoints:i.curPoints}:a.points!==i.curPoints?{curPoints:a.points}:null}},{key:"repeat",value:function(a,i){for(var o=a.length%2!==0?[].concat(D(a),[0]):a,s=[],l=0;l<i;++l)s=[].concat(D(s),D(o));return s}},{key:"renderDotItem",value:function(a,i){var o;if(x.isValidElement(a))o=x.cloneElement(a,i);else if(Se(a))o=a(i);else{var s=i.key,l=ue(i,He),u=se("recharts-line-dot",typeof a!="boolean"?a.className:"");o=x.createElement(Te,Y({key:s},l,{className:u}))}return o}}])}(y.PureComponent);A(q,"displayName","Line");A(q,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!$e.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});A(q,"getComposedData",function(e){var t=e.props,r=e.xAxis,a=e.yAxis,i=e.xAxisTicks,o=e.yAxisTicks,s=e.dataKey,l=e.bandSize,u=e.displayedData,h=e.offset,m=t.layout,f=u.map(function(d,c){var p=me(d,s);return m==="horizontal"?{x:ce({axis:r,ticks:i,bandSize:l,entry:d,index:c}),y:re(p)?null:a.scale(p),value:p,payload:d}:{x:re(p)?null:r.scale(p),y:ce({axis:a,ticks:o,bandSize:l,entry:d,index:c}),value:p,payload:d}});return b({points:f,layout:m},h)});var ot=Be({chartName:"LineChart",GraphicalChild:q,axisComponents:[{axisType:"xAxis",AxisComp:fe},{axisType:"yAxis",AxisComp:Fe}],formatAxisMap:ze});const L="http://localhost:9090/analytics",lt=async()=>(await k.get(`${L}/revenue`)).data,ct=async()=>(await k.get(`${L}/appointments`)).data,ut=async()=>(await k.get(`${L}/customers`)).data,dt=async()=>(await k.get(`${L}/revenue/current-year`)).data,pt=async()=>(await k.get(`${L}/popular-services`)).data,ht=async()=>(await k.get(`${L}/frequent-customers`)).data,mt=()=>{const{monthlyRevenue:e,monthlyAppointmens:t,monthlyNewCustomers:r,setMonthlyAppointmens:a,setMonthlyNewCustomers:i,setMonthlyRevenue:o,currentYearMonthlyRevenue:s,setCurrentYearMonthlyRevenue:l,monthlyPopularServices:u,setMonthlyPopularServices:h,frequentCustomersList:m,setFrequentCustomersList:f}=y.useContext(Ce);return y.useEffect(()=>{(async()=>{let c=await lt();o(c)})()},[]),y.useEffect(()=>{(async()=>{let c=await ct();a(c)})()},[]),y.useEffect(()=>{(async()=>{let c=await ut();i(c)})()},[]),y.useEffect(()=>{(async()=>{let c=await dt();l(c)})()},[]),y.useEffect(()=>{(async()=>{let c=await pt();h(c)})()},[]),y.useEffect(()=>{(async()=>{let c=await ht();f(c)})()},[]),{monthlyRevenue:e,monthlyAppointmens:t,monthlyNewCustomers:r,currentYearMonthlyRevenue:s,monthlyPopularServices:u,frequentCustomersList:m}},J=({title:e,text:t,avg:r})=>n.jsxs("div",{className:"rounded-lg shadow-sm border bg-white",children:[n.jsx("div",{className:"space-y-1.5 p-6 flex flex-row items-center justify-between pb-2",children:n.jsx("h3",{className:"text-sm font-medium",children:e})}),n.jsxs("div",{className:"p-6 pt-0",children:[n.jsx("div",{className:"text-2xl font-bold",children:t}),n.jsxs("p",{className:"text-xs text-zinc-600",children:[n.jsxs("span",{className:"text-emerald-500 font-medium",children:[r,"%"]})," desde el mes pasado"]})]})]}),ft={desktop:{label:"Ingresos"}},vt=({Data:e})=>{let t=e.map(r=>({mes:new Date(r.Month).toLocaleDateString("es-AR",{month:"long"}),ingresos:r.Month_revenue}));return n.jsxs(Q,{children:[n.jsxs(Z,{children:[n.jsx(ee,{children:"Tendencia de ingresos"}),n.jsx(te,{children:"Ingresos mensuales del año en curso"})]}),n.jsx(he,{children:n.jsx(Ge,{config:ft,children:n.jsxs(ot,{accessibilityLayer:!0,data:t,margin:{left:12,right:12},children:[n.jsx(Ye,{vertical:!1,horizontal:!1}),n.jsx(fe,{dataKey:"mes",tickLine:!1,axisLine:!1,tickMargin:8,tickFormatter:r=>r.slice(0,3)}),n.jsx(qe,{cursor:!1,content:n.jsx(We,{hideLabel:!0})}),n.jsx(q,{dataKey:"ingresos",type:"natural",stroke:"#000",strokeWidth:2,dot:!1})]})})})]})},yt=({PopularServicesList:e})=>n.jsxs("div",{className:"rounded-lg shadow-sm border bg-white",children:[n.jsxs("div",{className:"flex flex-col space-y-1.5 p-6",children:[n.jsx("h3",{className:"text-2xl font-semibold",children:"Servicios Populares"}),n.jsx("p",{className:"text-sm text-zinc-600",children:"Top servicios del mes"})]}),n.jsx("div",{className:"p-6 pt-0",children:e.length>0?n.jsx("ul",{className:"space-y-4",children:e.map(t=>n.jsxs("li",{className:"flex items-center justify-between",children:[n.jsx("h4",{className:"font-medium",children:t.Service_name})," ",n.jsx("span",{className:"text-sm text-zinc-600",children:t.Service_count})]}))}):n.jsx("p",{children:"Sin servicios"})})]}),xe=y.forwardRef(({className:e,...t},r)=>n.jsx("div",{className:"relative w-full overflow-auto",children:n.jsx("table",{ref:r,className:N("w-full caption-bottom text-sm",e),...t})}));xe.displayName="Table";const ge=y.forwardRef(({className:e,...t},r)=>n.jsx("thead",{ref:r,className:N("[&_tr]:border-b",e),...t}));ge.displayName="TableHeader";const be=y.forwardRef(({className:e,...t},r)=>n.jsx("tbody",{ref:r,className:N("[&_tr:last-child]:border-0",e),...t}));be.displayName="TableBody";const xt=y.forwardRef(({className:e,...t},r)=>n.jsx("tfoot",{ref:r,className:N("border-t bg-zinc-100/50 font-medium [&>tr]:last:border-b-0 dark:bg-zinc-800/50",e),...t}));xt.displayName="TableFooter";const ie=y.forwardRef(({className:e,...t},r)=>n.jsx("tr",{ref:r,className:N("border-b transition-colors hover:bg-zinc-100/50 data-[state=selected]:bg-zinc-100 dark:hover:bg-zinc-800/50 dark:data-[state=selected]:bg-zinc-800",e),...t}));ie.displayName="TableRow";const z=y.forwardRef(({className:e,...t},r)=>n.jsx("th",{ref:r,className:N("h-12 px-4 text-left align-middle font-medium text-zinc-500 [&:has([role=checkbox])]:pr-0 dark:text-zinc-400",e),...t}));z.displayName="TableHead";const G=y.forwardRef(({className:e,...t},r)=>n.jsx("td",{ref:r,className:N("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));G.displayName="TableCell";const gt=y.forwardRef(({className:e,...t},r)=>n.jsx("caption",{ref:r,className:N("mt-4 text-sm text-zinc-500 dark:text-zinc-400",e),...t}));gt.displayName="TableCaption";const bt=({TableData:e})=>n.jsxs(_e,{defaultValue:"Clientes principales",children:[n.jsxs(Ne,{className:"grid w-[300px] grid-cols-2",children:[n.jsx(oe,{value:"Clientes principales",children:"Clientes principales"}),n.jsx(oe,{value:"Barberos",children:"Barberos"})]}),n.jsx(le,{value:"Clientes principales",children:n.jsxs(Q,{children:[n.jsxs(Z,{children:[n.jsx(ee,{children:"Clientes principales"}),n.jsx(te,{children:"Clientes con mayor gasto y frecuencia"})]}),n.jsxs(xe,{children:[n.jsx(ge,{children:n.jsxs(ie,{children:[n.jsx(z,{children:"Clientes"}),n.jsx(z,{children:"Visitas"}),n.jsx(z,{children:"Total abonado"}),n.jsx(z,{children:"Ultima visita"})]})}),n.jsx(be,{children:e.map((t,r)=>n.jsxs(ie,{children:[n.jsxs(G,{className:"font-medium",children:[t.Customer_name," ",t.Customer_surname]}),n.jsx(G,{children:t.Visits_count}),n.jsxs(G,{children:["$",t.Total_spent]}),n.jsx(G,{className:"",children:new Date(t.Last_visit).toLocaleDateString("es-AR",{day:"numeric",month:"numeric",year:"numeric"})})]},r))})]})]})}),n.jsx(le,{value:"Barberos",children:n.jsxs(Q,{children:[n.jsxs(Z,{children:[n.jsx(ee,{children:"Barberos"}),n.jsx(te,{})]}),n.jsxs(he,{className:"space-y-2",children:[n.jsx("div",{className:"space-y-1"}),n.jsx("div",{className:"space-y-1"})]}),n.jsx(Pe,{children:n.jsx(Ke,{children:"Save changes"})})]})})]}),Ct=()=>{const{monthlyAppointmens:e,monthlyNewCustomers:t,monthlyRevenue:r,currentYearMonthlyRevenue:a,monthlyPopularServices:i,frequentCustomersList:o}=mt();return n.jsxs("div",{className:"",children:[n.jsx("header",{className:"p-3 border-b",children:n.jsx("h1",{className:"text-xl font-semibold",children:"Panel de administración"})}),n.jsx("main",{className:"p-6",children:n.jsxs("div",{className:"grid gap-6",children:[n.jsxs("section",{children:[n.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Resumen"}),n.jsxs("div",{className:"grid gap-6 sm:grid-cols-2 lg:grid-cols-4",children:[n.jsx(J,{avg:r!=null&&r.Avg_compared_last_month?r==null?void 0:r.Avg_compared_last_month:0,text:`$${r==null?void 0:r.Total_month_revenue}`,title:"Ganancias totales"}),n.jsx(J,{avg:e!=null&&e.Avg_compared_last_month?e==null?void 0:e.Avg_compared_last_month:0,text:`${e==null?void 0:e.Total_month_appointments}`,title:"Reservas"}),n.jsx(J,{avg:t!=null&&t.Avg_compared_last_month?t==null?void 0:t.Avg_compared_last_month:0,text:`${t==null?void 0:t.Total_month_new_users}`,title:"Nuevos Clientes"})]})]}),n.jsxs("section",{className:"grid gap-6 md:grid-cols-2",children:[n.jsx(vt,{Data:a}),n.jsx(yt,{PopularServicesList:i||[]})]}),n.jsx("section",{children:n.jsx(bt,{TableData:o})})]})})]})};export{Ct as default};
