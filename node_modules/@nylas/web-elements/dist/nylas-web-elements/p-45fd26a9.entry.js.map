{"version":3,"names":["NylasSchedulerConnector","constructor","schedulerAPIURL","nylasSchedulerStore","sessionId","configId","slug","clientId","Error","url","URL","window","location","href","origin","this","init","debug","schedulerStore","scheduler","_schedulerAPIConnector","NylaSchedulerAPIConnector","resetStores","reset","SchedulerView","props","children","isLoading","showNotification","nylasBranding","h","Fragment","class","target","rel","MessageBanner","_props","nylasSchedulingCss","NylasSchedulingStyle0","genericError","title","i18next","t","type","NotificationType","category","ErrorCategory","Component","NylasScheduling","Date","toLocaleDateString","undefined","dateStyle","navigator","language","connectedCallback","componentWillLoad","enableUserFeedback","Sentry.isInitialized","Sentry.init","dsn","release","integrations","filter","_integration","Sentry.feedbackIntegration","colorScheme","autoInject","autoSessionTracking","beforeSend","schedulerWillLoadEvent","schedulerWillLoad","emit","host","eventOverrides","nylasSchedulerConnector","defaultPrevented","stores","CreateNylasSchedulerStore","bookingInfo","themeConfig","defaultSchedulerState","baseProvider","NylasBaseProvider","automaticComponentRegistration","refConfigId","configurationId","bookingRefExtractedEvent","rescheduleBookingRef","rescheduleConfigId","rescheduleBookingId","_","compactStringToUUIDs","set","bookingRefExtracted","bookingId","cancelBookingRef","cancelConfigId","cancelBookingId","organizerConfirmationBookingRef","organizerConfirmationConfigId","organizerConfirmationBookingId","salt","checkIfSessionIdOrConfigIdExists","getStore","schedulerApiUrl","initEvent","applyThemeConfig","componentDidLoad","schedulerDidLoadEvent","schedulerDidLoad","localizationChanged","localization","settingsResponse","getUISettings","nylasSchedulerError","notification","getErrorObject","error","data","appearance","console","info","configSettingsLoadedEvent","configSettingsLoaded","settings","availableDaysInFuture","get","available_days_in_future","selectedTimeslot","start_time","isTimeslotValid","selectedDate","availability","result","length","today","startTime","endTime","endTimeForAvailableDaysInFuture","validateAvailableDaysInFuture","getTime","getAvailability","_selectedDate","firstAvailableDate","find","timeslot","componentDisconnected","bookingInfoChanged","newVal","rescheduleBookingRefChanged","setConfigId","cancelBookingRefChanged","organizerConfirmationBookingRefChanged","Object","keys","forEach","lang","LANGUAGE_CODE","addResourceBundle","themeConfigChanged","languageChanged","event","newLanguage","detail","changeLanguage","registerComponentHandler","registerComponent","unregisterComponentHandler","unregisterComponent","monthChangedHandler","date","selectableDates","mapToBookingData","timezone","end_time","additional_guests","guests","guest","primaryParticipant","additional_fields","additionalFields","email_language","bookButtonClickedHandler","bookingData","mappedBookingData","bookingInfoConfirmed","storeRescheduleId","rescheduleBooking","resultData","bookedEventInfoEvent","bookedEventInfo","bookTimeslot","dateSelectedHandler","selectedDateLabel","cancelBookedEventErrorHandler","cancelBookedEventValidationErrorHandler","rescheduleBookedEventErrorHandler","confirmBookingErrorHandler","feedbackModalClosedHandler","showFeedbackModal","feedbackSubmittedHandler","eventId","Sentry.captureMessage","feedback","message","Sentry.captureFeedback","includeReplay","captureContext","tags","extra","getNylasSchedulerStore","getNylasSchedulerConnector","getRef","description","id","toString","ttl","startDate","getFullYear","getMonth","endTimeForCurrentMonth","Math","floor","addDaysToCurrentDate","min","startTimeWithOffset","key","value","entries","style","setProperty","onFeedbackClick","e","preventDefault","redirectToCustomUrl","assign","render","showDefaultScheduler","mode","eventInfo","showBookingForm","cancelledEventInfo","rejectBookingId","confirmedEventInfo","redirectUrl","confirmation_redirect_url","capitalizeFirstLetter","LANGUAGE_CODE_MAP","Host","part","exportparts","variant","onClick","recipient","bookingInfoAdditionalFields","selectedTimezone","selectedLanguage","configSettings","configuration_id","queryString","search","urlParams","URLSearchParams","booking_id","name","email","JSON","stringify","timeslotPickerCTALabel","querySelector","slot"],"sources":["src/connector/nylas-scheduler-connector/index.ts","src/components/scheduler/nylas-scheduling/scheduler-view.tsx","src/components/scheduler/nylas-scheduling/message-banner.tsx","src/components/scheduler/nylas-scheduling/nylas-scheduling.scss?tag=nylas-scheduling&encapsulation=shadow","src/components/scheduler/nylas-scheduling/nylas-scheduling.tsx"],"sourcesContent":["import { NylasSchedulerStoreType } from '@/stores/scheduler-store';\nimport { debug } from '@/utils/utils';\nimport { NylasSchedulerConnectorInterface } from '../connector-interface';\nimport { NylaSchedulerAPIConnector } from '../shared/api/scheduler';\n\ntype NylasSchedulerConnectorOptions = {\n  schedulerAPIURL: string;\n  nylasSchedulerStore: NylasSchedulerStoreType;\n  sessionId?: string;\n  configId?: string;\n  slug?: string;\n  clientId?: string;\n};\n/**\n * Base class for the Nylas connector.\n */\nexport class NylasSchedulerConnector implements NylasSchedulerConnectorInterface {\n  public schedulerAPIURL: string;\n  public nylasSchedulerStore: NylasSchedulerStoreType;\n  public sessionId: string | undefined;\n  public configId: string | undefined;\n  public slug: string | undefined;\n  public clientId: string | undefined;\n\n  private _schedulerAPIConnector: NylaSchedulerAPIConnector | undefined;\n\n  constructor({ schedulerAPIURL, nylasSchedulerStore, sessionId, configId, slug, clientId }: NylasSchedulerConnectorOptions) {\n    if (!schedulerAPIURL) {\n      throw new Error('schedulerAPIURL is required');\n    }\n\n    if (!nylasSchedulerStore) {\n      throw new Error('nylasSchedulerStore is required');\n    }\n\n    if (!sessionId && !configId && !(slug || clientId)) {\n      throw new Error('sessionId is required for private configs. If using public config either pass a configurationId or a combination of slug and clientId.');\n    }\n\n    // If the url is only /, then we need to add the base url.\n    // We assume that the base url is the same as the current url.\n    if (schedulerAPIURL === '/') {\n      const url = new URL(window.location.href);\n      schedulerAPIURL = url.origin;\n    }\n\n    this.configId = configId;\n    this.sessionId = sessionId;\n    this.schedulerAPIURL = schedulerAPIURL;\n    this.nylasSchedulerStore = nylasSchedulerStore;\n    this.slug = slug;\n    this.clientId = clientId;\n  }\n\n  public init() {\n    debug('NylasConnector init');\n  }\n\n  public get schedulerStore() {\n    return this.nylasSchedulerStore;\n  }\n\n  public get scheduler() {\n    if (this._schedulerAPIConnector) {\n      return this._schedulerAPIConnector;\n    }\n    this._schedulerAPIConnector = new NylaSchedulerAPIConnector({\n      schedulerAPIURL: this.schedulerAPIURL,\n      schedulerStore: this.schedulerStore,\n      sessionId: this.sessionId,\n      configId: this.configId,\n      slug: this.slug,\n      clientId: this.clientId,\n    });\n    return this._schedulerAPIConnector;\n  }\n\n  public resetStores() {\n    this.nylasSchedulerStore.reset();\n  }\n}\nexport type PublicMethods<T> = {\n  [K in keyof T]: T[K] extends Function ? (string extends K ? never : K) : never;\n}[keyof T];\n\nexport type NylasSchedulerConnectorPublicMethods = PublicMethods<NylasSchedulerConnector>;\n","import { Fragment, FunctionalComponent, h } from '@stencil/core';\n\nexport type SchedulerViewProps = {\n  isLoading?: boolean;\n  showNotification?: boolean;\n  nylasBranding?: boolean;\n};\n\n/**\n * The Scheduler view component.\n */\nexport const SchedulerView: FunctionalComponent<SchedulerViewProps> = (props: SchedulerViewProps, children) => {\n  const isLoading = props.isLoading;\n  const showNotification = props.showNotification;\n  const nylasBranding = props.nylasBranding;\n\n  return (\n    <Fragment>\n      {showNotification && <nylas-notification></nylas-notification>}\n\n      {isLoading && (\n        <div class={'loading'}>\n          <div class={'left'}>\n            <div class={'skeleton'} />\n          </div>\n          <div class={'right'}>\n            <div class={'skeleton'} />\n            <div class={'skeleton'} />\n            <div class={'skeleton'} />\n            <div class={'skeleton'} />\n            <div class={'skeleton'} />\n          </div>\n        </div>\n      )}\n      {!isLoading && children}\n      <div class={'footer'}>\n        {nylasBranding && (\n          <a\n            href=\"https://scheduler.nylas.com?utm_source=powered-by-nylas-logoutm_medium=link&utm_campaign=get-scheduler&utm_id=get-scheduler\"\n            class=\"powered-by-nylas\"\n            target=\"_blank\"\n            rel=\"noreferrer noopener\"\n          >\n            Powered by&nbsp;<span class=\"sr-only\">Nylas</span>\n            <nylas-logo aria-hidden={true} />\n          </a>\n        )}\n      </div>\n    </Fragment>\n  );\n};\n","import { FunctionalComponent, h } from '@stencil/core';\n\nexport type HeaderBannerProps = {};\n\nexport const MessageBanner: FunctionalComponent<HeaderBannerProps> = (_props: HeaderBannerProps, children) => <div class=\"message-banner\">{children}</div>;\n","@import '../../../common/styles/variables.scss';\n\n:host {\n  display: flex;\n  flex-direction: column;\n  overflow: visible;\n  border-radius: var(--nylas-border-radius-2x);\n  width: fit-content;\n\n  @media #{$mobile} {\n    width: auto;\n    min-width: 325px;\n  }\n\n  background: var(--nylas-base-0);\n  position: relative;\n  box-shadow:\n    0px 4px 8px 2px rgba(0, 0, 0, 0.05),\n    0px 8px 16px -2px rgba(0, 0, 0, 0.1);\n\n  @include default-css-variables;\n  font-family: var(--nylas-font-family);\n  font-optical-sizing: auto;\n  font-style: normal;\n  font-variation-settings: 'slnt' 0;\n}\n\n:root {\n  font-family: inherit;\n}\n\n.error {\n  padding: 8rem 12rem;\n  color: var(--nylas-base-0);\n  background-color: var(--nylas-error);\n  margin: 1.5rem;\n  border-radius: var(--nylas-border-radius-2x);\n}\n\n.message-banner {\n  text-align: right;\n  color: var(--nylas-base-800);\n  padding: 1rem;\n  border-bottom: 1px solid var(--nylas-color-primary-200);\n  margin: 0;\n}\n\n.loading {\n  margin: 1.5rem;\n  display: flex;\n  gap: 1rem;\n\n  .skeleton {\n    border-radius: var(--nylas-border-radius-2x);\n    animation: pulsate 1.5s infinite;\n\n    &:nth-child(2) {\n      animation-delay: -100ms;\n    }\n\n    &:nth-child(3) {\n      animation-delay: -200ms;\n    }\n\n    &:nth-child(4) {\n      animation-delay: -300ms;\n    }\n\n    &:nth-child(5) {\n      animation-delay: -400ms;\n    }\n  }\n\n  .left .skeleton {\n    height: 100%;\n    width: 400px;\n  }\n\n  .right .skeleton {\n    height: 5rem;\n    width: 300px;\n    margin-bottom: 1rem;\n\n    &:last-child {\n      margin-bottom: 0;\n    }\n  }\n}\n\n@keyframes pulsate {\n  0% {\n    background-color: var(--nylas-base-50);\n  }\n\n  50% {\n    background-color: var(--nylas-base-100);\n  }\n\n  100% {\n    background-color: var(--nylas-base-50);\n  }\n}\n\n.select-date-page,\n.additional-data-page,\n.booked-event-page,\n.manual-confirmation-page,\n.cancelled-event-page,\n.cancel-flow-page {\n  border-top-left-radius: var(--nylas-border-radius-2x);\n  border-top-right-radius: var(--nylas-border-radius-2x);\n}\n\n.select-date-page,\n.additional-data-page {\n  display: flex;\n\n  @media #{$mobile} {\n    flex-direction: column;\n  }\n}\n\n.booked-event-page,\n.manual-confirmation-page {\n  background-color: var(--nylas-base-50);\n}\n\n.cancelled-event-page,\n.manual-confirmation-page,\n.cancel-flow-page {\n  padding: 1rem;\n  height: 496px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.booked-event-page,\n.manual-confirmation-page,\n.cancelled-event-page,\n.cancel-flow-page {\n  min-width: 784px;\n\n  @media #{$mobile} {\n    min-width: 90%;\n  }\n\n  background: var(--nylas-base-50);\n}\n\n.left-panel {\n  display: flex;\n  flex-direction: column;\n  min-width: 424px;\n  border-top-left-radius: inherit;\n  background: var(--nylas-base-0);\n  position: relative;\n  padding: 1rem 0 0 0;\n  height: 624px;\n\n  @media #{$mobile} {\n    border-top-right-radius: inherit;\n    min-width: unset;\n    height: auto;\n  }\n}\n\n.select-date-page .left-panel {\n  @media #{$mobile} {\n    padding: 0.5rem 4px 0;\n    height: 624px;\n  }\n}\n\n.border {\n  margin-left: -20px; // Offset left padding\n  margin-right: -20px; // Offset right padding\n  border-top-width: 1px;\n  height: 0.5px;\n  background-color: var(--nylas-base-200);\n\n  @media #{$mobile} {\n    display: none;\n  }\n}\n\n.right-panel {\n  min-width: 360px;\n  width: 360px;\n  background-color: var(--nylas-base-50);\n  height: 624px;\n  padding-top: 16px;\n  border-left: 1px solid var(--nylas-base-200);\n  border-top-right-radius: inherit;\n\n  &.reschedule {\n    border-top-right-radius: 0px;\n  }\n\n  @media #{$mobile} {\n    border-top-right-radius: 0px;\n    width: inherit;\n    min-width: unset;\n    height: auto;\n  }\n\n  h2 {\n    display: flex;\n    margin: 0;\n    height: 48px;\n    gap: 0.5rem;\n    justify-content: center;\n    align-items: center;\n    width: auto;\n    font-size: 1.125rem;\n    line-height: 1.5rem;\n    font-weight: 500;\n    text-align: center;\n    color: var(--nylas-base-800);\n  }\n}\n\n.additional-data-page {\n  .left-panel {\n    background-color: var(--nylas-base-50);\n  }\n\n  .right-panel {\n    background-color: var(--nylas-base-0);\n  }\n}\n\nnylas-selected-event-card {\n  height: calc(640px - 36px);\n  padding: 0 1rem;\n\n  @media #{$mobile} {\n    height: 250px;\n  }\n}\n\n.footer {\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  padding: 16px;\n  font-size: 14px;\n  font-weight: 300;\n  color: var(--nylas-base-500);\n  border-top: 1px solid var(--nylas-base-200);\n  min-height: 24px;\n\n  .powered-by-nylas {\n    display: flex;\n    align-items: center;\n    text-decoration: none;\n\n    color: var(--nylas-base-500);\n\n    &:hover {\n      color: var(--nylas-base-800);\n    }\n  }\n\n  svg {\n    fill: var(--nylas-base-500);\n  }\n}\n\n.sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.footer svg {\n  margin-top: 1px;\n}\n\nnylas-selected-event-card::part(nsec__timezone) {\n  position: absolute;\n  bottom: 0;\n}\n\nnylas-notification {\n  margin: 1.5rem;\n  width: -webkit-fill-available;\n  width: -moz-available;\n  position: absolute;\n}\n\nnylas-locale-switch {\n  position: absolute;\n  padding: 18px 20px;\n  bottom: 0;\n  width: -webkit-fill-available;\n  width: -moz-available;\n  border-top: 1px solid var(--nylas-base-200);\n\n  @media #{$mobile} {\n    height: auto;\n  }\n}\n\nnylas-date-picker {\n  padding: 0 20px;\n}\n\nbutton-component#report-issue {\n  width: auto;\n  position: absolute;\n  bottom: 4px;\n  left: 16px;\n}\n\nnylas-feedback-form {\n  position: absolute;\n  top: 0;\n  height: 100%;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  background: rgba(0, 0, 0, 0.6);\n  z-index: 2;\n  border-radius: inherit;\n}\n","import { NylasBaseProvider } from '@/common/abstract-provider';\nimport { RegisteredComponent } from '@/common/register-component';\nimport type { SchedulerEventOverride } from '@/common/component-types';\nimport { NylasSchedulerConnector } from '@/connector/nylas-scheduler-connector';\nimport { CreateNylasSchedulerStore, NylasSchedulerStoreState, NylasSchedulerStoreType } from '@/stores/scheduler-store';\nimport {\n  NylasSchedulerBookingData,\n  ThemeConfig,\n  Notification,\n  NotificationType,\n  NylasSchedulerErrorResponse,\n  Timeslot,\n  NylasSchedulerResponse,\n  NylasSuccessResponse,\n} from '@nylas/core';\nimport { Component, Element, Event, EventEmitter, Host, Listen, Method, Prop, State, Watch, h } from '@stencil/core';\nimport { addDaysToCurrentDate, capitalizeFirstLetter, compactStringToUUIDs, debug } from '@/utils/utils';\nimport { SchedulerView } from './scheduler-view';\nimport { ErrorCategory } from '@/connector/nylas-scheduler-connector/errors';\nimport { MessageBanner } from './message-banner';\nimport i18next from '@/utils/i18n';\nimport { NylasSchedulerBookingDataWithFlatFields, NylasEvent, UISettingsResponse } from '@/common/types';\nimport { LANGUAGE_CODE, LANGUAGE_CODE_MAP, Locale } from '@/common/constants';\nimport * as Sentry from '@sentry/browser';\n\nconst genericError = { title: i18next.t('genericErrorTitle'), type: NotificationType.Error, category: ErrorCategory.Component };\n\n/**\n * The `nylas-scheduling` component is used to display the Nylas Scheduling UI.\n *\n * @part ndp - [nylas-date-picker] The date picker host.\n * @part ndp__title - [nylas-date-picker] The title.\n * @part ndp__month-header - [nylas-date-picker] The month header.\n * @part ndp__month-button - [nylas-date-picker] The month button.\n * @part ndp__day - [nylas-date-picker] The day.\n * @part ndp__date - [nylas-date-picker] The date.\n * @part ndp__date--selected - [nylas-date-picker] The selected date.\n * @part ndp__date--current-day - [nylas-date-picker] The current day.\n * @part ndp__date--current-month - [nylas-date-picker] The dates in the current month.\n * @part ndp__date--disabled - [nylas-date-picker] The disabled dates.\n * @part ntp - [nylas-timeslot-picker] The timeslot picker component.\n * @part ntp__timeslot - [nylas-timeslot-picker] The timeslot button.\n * @part ntp__timeslot--selected - [nylas-timeslot-picker] The selected timeslot button.\n * @part ntp__button-primary - [nylas-timeslot-picker] The timeslot picker CTA.\n * @part nsec - [nylas-selected-event-card] The selected event card component.\n * @part nsec__card - [nylas-selected-event-card] The card component.\n * @part nsec__icon - [nylas-selected-event-card] The calendar icon.\n * @part nsec__date - [nylas-selected-event-card] The date selected.\n * @part nsec__time - [nylas-selected-event-card] The timeslot selected.\n * @part nbf - [nylas-booking-form] The booking form host.\n * @part nbf__input-textfield - [nylas-booking-form] The input textfield.\n * @part nbf__button-ghost - [nylas-booking-form] The ghost button.\n * @part nbf__button-outline - [nylas-booking-form] The outline button.\n * @part nbf__button-primary - [nylas-booking-form] The primary button.\n * @part nbf__input-wrapper - [nylas-booking-form] The input wrapper.\n * @part nbf__checkbox-component - [nylas-booking-form] The checkbox component.\n * @part nbf__radio-button-group - [nylas-booking-form] The radio button group.\n * @part nbf__textarea-component - [nylas-booking-form] The textarea component.\n * @part nbf__dropdown - [nylas-booking-form] The dropdown component.\n * @part nbf__dropdown-button - [nylas-booking-form] The dropdown button.\n * @part nbf__dropdown-content - [nylas-booking-form] The dropdown content.\n * @part ncec - [nylas-cancelled-event-card] The cancelled event card host.\n * @part ncec__icon - [nylas-cancelled-event-card] The calendar icon.\n * @part ncec__title - [nylas-cancelled-event-card] The title of the cancelled event card.\n * @part ncec__description - [nylas-cancelled-event-card] The description of the cancelled event card.\n * @part ncec__button-outline - [nylas-cancelled-event-card] The close button CTA.\n * @part ncec__card - [nylas-cancelled-event-card] The cancelled event card.\n * @part nbec - [nylas-booked-event-card] The booked event card host.\n * @part nbec__card - [nylas-booked-event-card] The booked event card.\n * @part nbec__title - [nylas-booked-event-card] The title of the booked event card.\n * @part nbec__description - [nylas-booked-event-card] The description of the booked event card.\n * @part nbec__button-outline - [nylas-booked-event-card] The cancel & reschedule button CTA.\n * @part nbec__cancel-cta - [nylas-booked-event-card] The cancel button CTA.\n * @part nbec__reschedule-cta - [nylas-booked-event-card] The reschedule button CTA.\n * @part nls - [nylas-locale-switch] The locale switch container.\n * @part nls__timezone - [nylas-locale-switch] The timezone select container\n * @part nls__timezone-dropdown - [nylas-locale-switch] The timezone dropdown\n * @part nls__timezone-drop-button - [nylas-locale-switch] The timezone dropdown button\n * @part nls__timezone-drop-button-selected-label - [nylas-locale-switch] The timezone dropdown button selected label\n * @part nls__timezone-drop-content - [nylas-locale-switch] The timezone dropdown content\n * @part nls__timezone-drop-label - [nylas-locale-switch] The timezone dropdown label\n * @part nls__language - [nylas-locale-switch] The language select container\n * @part nls__language-dropdown - [nylas-locale-switch] The language dropdown\n * @part nls__language-drop-button - [nylas-locale-switch] The language dropdown button\n * @part nls__language-drop-content - [nylas-locale-switch] The language dropdown content\n * @part nls__language-drop-label - [nylas-locale-switch] The language dropdown label\n * @part ncbf - [nylas-cancel-booking-form] The cancel booking form container.\n * @part ncbf__icon - [nylas-cancel-booking-form] The calendar icon.\n * @part ncbf__title - [nylas-cancel-booking-form] The title of the cancel booking form.\n * @part ncbf__description - [nylas-cancel-booking-form] The description of the cancel booking form.\n * @part ncbf__reason-textarea - [nylas-cancel-booking-form] The reason textarea.\n * @part ncbf__button-cta - [nylas-cancel-booking-form] The cancel booking form CTA button.\n * @part ncbf__button-outline - [nylas-cancel-booking-form] The cancel booking form outline button.\n * @part ncbf__card - [nylas-cancel-booking-form] The cancel booking form card.\n */\n@Component({\n  tag: 'nylas-scheduling',\n  styleUrl: 'nylas-scheduling.scss',\n  shadow: true,\n})\nexport class NylasScheduling {\n  /**\n   * Stores to be used by the provider.\n   */\n  private stores?: { scheduler: NylasSchedulerStoreType };\n\n  /**\n   * This is a base provide that defines the common methods and properties\n   * that all providers should have.\n   *\n   * Because stencil does not support abstract classes, we have to use a\n   * property to store the base provider instance.\n   */\n  private baseProvider?: NylasBaseProvider<Exclude<typeof this.stores, undefined>>;\n\n  /**\n   * The Nylas Scheduler Connector instance.\n   * The branins of the provider. It manages data fetching and state synchronization.\n   */\n  private nylasSchedulerConnector?: NylasSchedulerConnector;\n\n  /**\n   * The host element.\n   * Used to manage the host element of the provider.\n   */\n  @Element() private host!: HTMLNylasSchedulingElement;\n\n  /**\n   * This is used to set the mode for the Nylas Scheduler.\n   * The mode can be either `app` or `composable`. The default mode is `app`.\n   * - `app`: This mode is used to show the default Nylas Scheduler UI.\n   * - `composable`: This mode is used to show the composable Nylas Scheduler UI\n   *    by passing the individual scheduler components as children.\n   */\n  @Prop() readonly mode: 'app' | 'composable' = 'app';\n\n  /**\n   * The default scheduler store state.\n   * Used to set the initial state of the scheduler store.\n   */\n  @Prop({ attribute: 'default-scheduler-store-state' }) readonly defaultSchedulerState?: Partial<NylasSchedulerStoreState>;\n\n  /**\n   * The session ID for the Nylas Scheduler.\n   * This is used to authenticate the user.\n   */\n  @Prop() readonly sessionId?: string;\n\n  /**\n   * The URL for the Nylas Scheduler API. (staging or production URL)\n   */\n  @Prop() readonly schedulerApiUrl: string = 'https://api.us.nylas.com';\n\n  /**\n   * This enables passing the bookingInfo object to the Scheduler UI for direct booking event creation.\n   * When used with timeslotConfirmedHandler, it bypasses the additional data page and immediately\n   * invokes the handler after booking.\n   */\n  @Prop() readonly bookingInfo?: NylasSchedulerBookingData;\n\n  /**\n   * Booking Ref required for rescheduling flow.\n   */\n  @Prop() readonly rescheduleBookingRef?: string;\n\n  /**\n   * Booking Ref required for cancelling flow.\n   */\n  @Prop() readonly cancelBookingRef?: string;\n\n  /**\n   * Booking Ref required for the manual confirmation flow.\n   */\n  @Prop() readonly organizerConfirmationBookingRef?: string;\n\n  /**\n   * The config ID for the Nylas Scheduler. This should be passed in when using a public config,\n   * in which case the sessionId is not required.\n   */\n  @Prop() readonly configurationId?: string;\n\n  /**\n   * The slug of the configuration (public config) to be used for the Nylas Scheduler. This is used in conjunction with the clientId.\n   * When the configurationId is not provided, the slug and clientId are used to make requests to the Scheduler API endpoints.\n   * If the configurationId is provided, this prop will be ignored.\n   */\n  @Prop() readonly slug?: string;\n\n  /**\n   * The app ID of the configuration (public config) to be used for the Nylas Scheduler. This is used in conjunction with the slug.\n   * When the configurationId is not provided, the slug and clientId are used to make requests to the Scheduler API endpoints.\n   * If the configurationId is provided, this prop will be ignored.\n   */\n  @Prop() readonly clientId?: string;\n\n  /**\n   * This prop lets you hide the Nylas branding.\n   * Default is true.\n   */\n  @Prop() readonly nylasBranding?: boolean = true;\n\n  /**\n   * This provides an easy way to override the default function of the event emitter.\n   * An example of this is the `timeslotConfirmed` event. By default, this event will set the scheduler store state for `showBookingForm` to `true` which will\n   * show the booking form. However, if you want to override this behavior, you can pass in the prop `eventOverride` like:\n   * ```html\n   * <nylas-scheduling eventOverride={{\"timeslotConfirmed\": (event, nylasConnector) => { console.log(\"Timeslot confirmed event fired!\"); } }} />\n   * ```\n   */\n  @Prop({ attribute: 'event-overrides' }) readonly eventOverrides: SchedulerEventOverride = {};\n\n  /**\n   * The loading state. This is used to set the loading state for the Nylas Scheduler when fetching data.\n   */\n  @Prop() readonly isLoading?: boolean;\n\n  /**\n   * Theme config, used to automatically generate a theme with color palette and\n   * CSS variables to customize the look and feel of the Nylas Scheduler.\n   */\n  @Prop() readonly themeConfig?: ThemeConfig;\n\n  /**\n   * This prop will allow to override the default localization strings for each language.\n   * Nylas scheduling page currently support the following language codes: en, es, fr, de, sv, zh, ja, nl.\n   */\n  @Prop() readonly localization?: Partial<Record<LANGUAGE_CODE, Locale>>;\n\n  /*\n   * Displays notifications for errors by default. When enabled (`true`), errors\n   * automatically appear as notifications. Disabling this feature (`false`) allows\n   * the parent application to capture and manage errors by listening to the\n   * `nylasSchedulerError` event, providing flexibility in error handling.\n   */\n  @Prop() readonly showNotification?: boolean = true;\n\n  @Prop() readonly enableUserFeedback?: boolean = true;\n\n  /**\n   * Automatically register components that have the `@RegisterComponent` decorator.\n   * If this is set to false, you will need to manually register components using the\n   * `registerComponent` method.\n   * @default true\n   */\n  @State() automaticComponentRegistration: boolean = true;\n\n  /**\n   * The selected date label for the Nylas Scheduler.\n   * This is used to set the initial date label for the Nylas Scheduler.\n   */\n  @State() selectedDateLabel: string = new Date().toLocaleDateString(undefined, { dateStyle: 'full' }) || `${i18next.t('noDateSelected')}`;\n\n  /**\n   * The config id extracted from the rescheduleBookingRef or cancelBookingRef or organizerConfirmationBookingRef.\n   */\n  @State() refConfigId?: string;\n\n  /**\n   * The selected language for the Nylas Scheduler.\n   */\n  @State() language: string = navigator.language;\n\n  /**\n   * The state for showing the feedback modal.\n   */\n  @State() showFeedbackModal: boolean = false;\n\n  /**\n   * The state of bookingInfo after the user has confirmed the booking.\n   */\n  @State() bookingInfoConfirmed: NylasSchedulerBookingDataWithFlatFields | null = null;\n\n  /**\n   * This event is fired when the provider is initialized.\n   * It can be used to set the initial state of the provider,\n   * or to prevent the provider from firing some default behavior.\n   */\n  @Event({ cancelable: true }) init!: EventEmitter<HTMLNylasSchedulingElement>;\n\n  /**\n   * This event is fired when the scheduler component enters componentWillLoad lifecycle.\n   */\n  @Event() schedulerWillLoad!: EventEmitter<HTMLNylasSchedulingElement>;\n\n  /**\n   * This event is fired when the scheduler component enters componentDidLoad lifecycle.\n   */\n  @Event() schedulerDidLoad!: EventEmitter<HTMLNylasSchedulingElement>;\n\n  @Event({\n    eventName: 'nylasSchedulerError',\n  })\n  nylasSchedulerError!: EventEmitter<{ notification: Notification; host: HTMLElement }>;\n\n  @Event({\n    eventName: 'configSettingsLoaded',\n  })\n  configSettingsLoaded!: EventEmitter<{ settings: NylasSchedulerResponse<UISettingsResponse> }>;\n\n  /**\n   * This event is triggered if either the rescheduleBookingRef or cancelBookingRef or organizerConfirmationBookingRef prop\n   * is supplied and the component has been attached to the DOM. It emits the configurationId\n   * and bookingId derived from the rescheduleBookingRef or cancelBookingRef or organizerConfirmationBookingRef. Subscribe to this\n   * event to obtain the extracted configurationId, which is necessary to generate the sessionID\n   * for configurations that are not public.\n   */\n  @Event() bookingRefExtracted!: EventEmitter<{ configurationId: string; bookingId: string; salt?: string }>;\n\n  /**\n   * This event is triggered on successful booking request. It emits the event data.\n   */\n  @Event() bookedEventInfo!: EventEmitter<NylasSchedulerResponse<NylasEvent>>;\n\n  /**\n   * This function is called when the component is connected to the DOM.\n   * At this point in the component lifecycle, the base provider has not yet\n   * been initialized. So avoid using the base provider in this method or stores\n   * in this method.\n   */\n  connectedCallback() {\n    debug(`[nylas-scheduler] connectedCallback`);\n  }\n\n  async componentWillLoad() {\n    debug(`[nylas-scheduler] Component will load`);\n\n    if (this.enableUserFeedback && !Sentry.isInitialized()) {\n      Sentry.init({\n        dsn: 'https://9d5731f1c77ca84c9ed3fb9b3ccf7ee1@o74852.ingest.us.sentry.io/4507889638178816',\n        release: process.env.PACKAGE_VERSION,\n        integrations: integrations => [\n          ...integrations.filter(_integration => false), // Removes default integrations (including Breadcrumbs)\n          Sentry.feedbackIntegration({\n            colorScheme: 'system',\n            autoInject: false,\n          }),\n        ],\n        // Disable all other event capture\n        autoSessionTracking: false, // Disable session tracking\n        beforeSend: () => null, // Prevents error events from being sent\n      });\n    }\n\n    // Emit the schedulerWillLoad event to allow the parent application to set the initial\n    // state of the provider or to prevent the provider from firing some default behavior.\n    const schedulerWillLoadEvent = this.schedulerWillLoad.emit(this.host);\n    if ('schedulerWillLoad' in this.eventOverrides) {\n      await this.eventOverrides.schedulerWillLoad(schedulerWillLoadEvent, this.nylasSchedulerConnector);\n      if (schedulerWillLoadEvent.defaultPrevented) {\n        return;\n      }\n    }\n\n    this.stores = {\n      scheduler: CreateNylasSchedulerStore({\n        bookingInfo: this.bookingInfo,\n        nylasBranding: this.nylasBranding,\n        themeConfig: this.themeConfig,\n        ...this.defaultSchedulerState,\n      }),\n    };\n\n    this.baseProvider = new NylasBaseProvider(this.host, this.stores, this.automaticComponentRegistration, this.eventOverrides);\n\n    // Set the configId to the reschedule configId if rescheduleBookingRef is provided or\n    // Set the configId to the cancel configId if cancelBookingRef is provided\n    this.refConfigId = this.configurationId;\n    let bookingRefExtractedEvent;\n    if (this.rescheduleBookingRef) {\n      const [rescheduleConfigId, rescheduleBookingId, _] = compactStringToUUIDs(this.rescheduleBookingRef);\n      this.refConfigId = rescheduleConfigId;\n      this.stores.scheduler.set('rescheduleBookingId', rescheduleBookingId);\n      bookingRefExtractedEvent = this.bookingRefExtracted.emit({ configurationId: rescheduleConfigId, bookingId: rescheduleBookingId });\n    } else if (this.cancelBookingRef) {\n      const [cancelConfigId, cancelBookingId, _] = compactStringToUUIDs(this.cancelBookingRef);\n      this.refConfigId = cancelConfigId;\n      this.stores.scheduler.set('cancelBookingId', cancelBookingId);\n      bookingRefExtractedEvent = this.bookingRefExtracted.emit({ configurationId: cancelConfigId, bookingId: cancelBookingId });\n    } else if (this.organizerConfirmationBookingRef) {\n      const [organizerConfirmationConfigId, organizerConfirmationBookingId, salt] = compactStringToUUIDs(this.organizerConfirmationBookingRef);\n      this.refConfigId = organizerConfirmationConfigId;\n      this.stores.scheduler.set('organizerConfirmationBookingId', organizerConfirmationBookingId);\n      this.stores.scheduler.set('organizerConfirmationSalt', salt);\n      bookingRefExtractedEvent = this.bookingRefExtracted.emit({ configurationId: organizerConfirmationConfigId, bookingId: organizerConfirmationBookingId, salt: salt });\n    }\n\n    if ('bookingRefExtracted' in this.eventOverrides) {\n      await this.eventOverrides.bookingRefExtracted(bookingRefExtractedEvent, this.nylasSchedulerConnector);\n      if (bookingRefExtractedEvent.defaultPrevented) {\n        return;\n      }\n    }\n\n    if (!this.checkIfSessionIdOrConfigIdExists()) {\n      return;\n    }\n\n    const nylasSchedulerStore = this.baseProvider?.getStore('scheduler');\n    this.nylasSchedulerConnector = new NylasSchedulerConnector({\n      schedulerAPIURL: this.schedulerApiUrl,\n      sessionId: this.sessionId,\n      configId: this.refConfigId,\n      slug: this.slug,\n      clientId: this.clientId,\n      nylasSchedulerStore,\n    });\n\n    const initEvent = this.init.emit(this.host);\n    if ('init' in this.eventOverrides) {\n      await this.eventOverrides.init(initEvent, this.nylasSchedulerConnector);\n      if (initEvent.defaultPrevented) {\n        return;\n      }\n    }\n\n    this.baseProvider?.componentWillLoad(this.nylasSchedulerConnector);\n    // Override theme\n    this.applyThemeConfig(this.themeConfig);\n  }\n\n  async componentDidLoad() {\n    this.baseProvider?.componentDidLoad();\n\n    const schedulerDidLoadEvent = this.schedulerDidLoad.emit(this.host);\n    if ('schedulerDidLoad' in this.eventOverrides) {\n      await this.eventOverrides.schedulerDidLoad(schedulerDidLoadEvent, this.nylasSchedulerConnector);\n      if (schedulerDidLoadEvent.defaultPrevented) {\n        return;\n      }\n    }\n\n    // If sessionId is not provided, do not fetch availability\n    if (!this.checkIfSessionIdOrConfigIdExists()) {\n      return;\n    }\n    this.localizationChanged(this.localization);\n    const settingsResponse = await this.nylasSchedulerConnector?.scheduler.getUISettings();\n    if (!settingsResponse || 'error' in settingsResponse) {\n      this.nylasSchedulerError.emit({ notification: { ...this.getErrorObject(settingsResponse?.error) }, host: this.host });\n      return;\n    } else {\n      if ('data' in settingsResponse && settingsResponse.data?.appearance) {\n        console.info(\n          'Appearance settings have been returned from the configuration used byt his scheduling page; please remember to grab them from the configSettingsLoaded event and apply them as desired.',\n        );\n      }\n      const configSettingsLoadedEvent = this.configSettingsLoaded.emit({ settings: settingsResponse });\n      if ('configSettingsLoaded' in this.eventOverrides) {\n        await this.eventOverrides.configSettingsLoaded(configSettingsLoadedEvent, this.nylasSchedulerConnector);\n        if (configSettingsLoadedEvent.defaultPrevented) {\n          return;\n        }\n      }\n    }\n\n    const nylasSchedulerStore = this.baseProvider?.getStore('scheduler');\n    const availableDaysInFuture = nylasSchedulerStore?.get('configSettings')?.scheduler?.available_days_in_future;\n    const selectedTimeslot = nylasSchedulerStore?.get('selectedTimeslot');\n\n    if (selectedTimeslot && selectedTimeslot?.start_time) {\n      if (!this.isTimeslotValid(selectedTimeslot)) {\n        return;\n      }\n\n      // If the selected timeslot is already set, do not fetch availability\n      if (nylasSchedulerStore?.get('showBookingForm')) {\n        nylasSchedulerStore?.set('selectedDate', selectedTimeslot.start_time);\n        return;\n      }\n    }\n\n    const selectedDate = nylasSchedulerStore?.get('selectedDate');\n    const availability = nylasSchedulerStore?.get('availability');\n    let result;\n\n    if (availability && availability.length > 0) {\n      return;\n    }\n\n    if (!selectedDate) {\n      const today = new Date();\n      const { startTime, endTime, endTimeForAvailableDaysInFuture } = this.validateAvailableDaysInFuture(today, availableDaysInFuture || 30);\n      if (today.getTime() < endTimeForAvailableDaysInFuture * 1000) {\n        result = await this.nylasSchedulerConnector?.scheduler.getAvailability(startTime, endTime);\n      }\n    } else {\n      const { startTime, endTime, endTimeForAvailableDaysInFuture } = this.validateAvailableDaysInFuture(selectedDate, availableDaysInFuture || 30);\n      if (selectedDate.getTime() < endTimeForAvailableDaysInFuture * 1000) {\n        result = await this.nylasSchedulerConnector?.scheduler.getAvailability(startTime, endTime);\n      }\n    }\n\n    if (!result || 'error' in result) {\n      this.nylasSchedulerError.emit({ notification: { ...this.getErrorObject(result?.error) }, host: this.host });\n    }\n\n    if (!selectedDate) {\n      let _selectedDate = new Date();\n      const firstAvailableDate = nylasSchedulerStore?.get('availability').find((timeslot: any) => new Date(timeslot.start_time) > new Date());\n      if (firstAvailableDate) {\n        _selectedDate = firstAvailableDate.start_time;\n      }\n      nylasSchedulerStore?.set('selectedDate', _selectedDate);\n    }\n  }\n\n  componentDisconnected() {\n    this.baseProvider?.componentDisconnected();\n  }\n\n  @Watch('bookingInfo')\n  bookingInfoChanged(newVal?: NylasSchedulerBookingData) {\n    this.stores?.scheduler.set('bookingInfo', newVal);\n  }\n\n  @Watch('rescheduleBookingRef')\n  rescheduleBookingRefChanged(newVal?: string) {\n    if (newVal) {\n      const [configId, bookingId] = compactStringToUUIDs(newVal);\n      this.stores?.scheduler.set('rescheduleBookingId', bookingId);\n      this.refConfigId = configId;\n      this.nylasSchedulerConnector?.scheduler.setConfigId(configId);\n    }\n  }\n\n  @Watch('cancelBookingRef')\n  cancelBookingRefChanged(newVal?: string) {\n    if (newVal) {\n      const [configId, bookingId] = compactStringToUUIDs(newVal);\n      this.stores?.scheduler.set('cancelBookingId', bookingId);\n      this.refConfigId = configId;\n      this.nylasSchedulerConnector?.scheduler.setConfigId(configId);\n    }\n  }\n\n  @Watch('organizerConfirmationBookingRef')\n  organizerConfirmationBookingRefChanged(newVal?: string) {\n    if (newVal) {\n      const [configId, bookingId] = compactStringToUUIDs(newVal);\n      this.stores?.scheduler.set('organizerConfirmationBookingId', bookingId);\n      this.refConfigId = configId;\n      this.nylasSchedulerConnector?.scheduler.setConfigId(configId);\n    }\n  }\n\n  @Watch('localization')\n  localizationChanged(newVal?: Partial<Record<LANGUAGE_CODE, Locale>>) {\n    if (!newVal) {\n      return;\n    }\n\n    Object.keys(newVal).forEach(lang => {\n      if (!(lang in LANGUAGE_CODE)) {\n        return;\n      }\n      i18next.addResourceBundle(\n        lang,\n        'translation',\n        newVal[lang],\n        false, // Merge with existing translations\n        true, // Replace the existing translations with the same key\n      );\n    });\n  }\n\n  @Watch('themeConfig')\n  themeConfigChanged(newVal?: ThemeConfig) {\n    // Set the theme config in the store, hosted page will use this to apply/re-apply the theme\n    this.baseProvider?.getStore('scheduler')?.set('themeConfig', newVal);\n    this.applyThemeConfig(newVal);\n  }\n\n  @Listen('languageChanged')\n  languageChanged(event: CustomEvent<string>) {\n    const newLanguage = event.detail;\n    this.language = newLanguage;\n    i18next.changeLanguage(newLanguage);\n  }\n\n  /**\n   * This is a custom event handler that is used to register a component with the provider.\n   * It is used by components that have the `@RegisterComponent` decorator.\n   * @param event A custom event that contains the component to register\n   * @returns Promise<void>\n   */\n  @Listen('registerComponent')\n  async registerComponentHandler(event: CustomEvent<RegisteredComponent<any, any>>): Promise<void> {\n    this.baseProvider?.registerComponent(event.detail);\n  }\n\n  /**\n   * This is a custom event handler that is used to unregister a component with the provider.\n   * It is used by components that have the `@RegisterComponent` decorator.\n   * @param event A custom event that contains the component to unregister\n   * @returns Promise<void>\n   */\n  @Listen('unregisterComponent')\n  async unregisterComponentHandler(event: CustomEvent<RegisteredComponent<any, any>>): Promise<void> {\n    this.baseProvider?.unregisterComponent(event.detail);\n  }\n\n  /**\n   * This is a custom event handler that is used to refetch the availability when the month is changed.\n   */\n  @Listen('monthChanged')\n  async monthChangedHandler(event: CustomEvent<Date>) {\n    const date = event.detail;\n    const availableDaysInFuture = this.nylasSchedulerConnector?.schedulerStore?.get('configSettings')?.scheduler?.available_days_in_future;\n    const { startTime, endTime, endTimeForAvailableDaysInFuture } = this.validateAvailableDaysInFuture(date, availableDaysInFuture || 30);\n\n    if (event.defaultPrevented) {\n      return;\n    }\n\n    if (startTime < endTimeForAvailableDaysInFuture && date.getTime() < endTimeForAvailableDaysInFuture * 1000) {\n      const result = await this.nylasSchedulerConnector?.scheduler.getAvailability(startTime, endTime);\n\n      if (!result || 'error' in result) {\n        this.nylasSchedulerError.emit({ notification: { ...this.getErrorObject(result?.error) }, host: this.host });\n      }\n      const selectableDates = this.stores?.scheduler.get('selectableDates');\n      if (selectableDates && selectableDates.length > 0) {\n        this.stores?.scheduler.set('selectedDate', selectableDates[0]);\n      }\n    }\n  }\n\n  mapToBookingData(bookingInfo: NylasSchedulerBookingDataWithFlatFields): any {\n    const timeslot = this.stores?.scheduler.get('selectedTimeslot');\n    const language = this.stores?.scheduler.get('selectedLanguage');\n    const timezone = this.stores?.scheduler.get('selectedTimezone');\n    const startTime = timeslot?.start_time ? new Date(timeslot?.start_time).getTime() / 1000 : '';\n    const endTime = timeslot?.end_time ? new Date(timeslot?.end_time).getTime() / 1000 : '';\n    return {\n      additional_guests: bookingInfo.guests,\n      guest: { ...bookingInfo.primaryParticipant },\n      additional_fields: { ...bookingInfo.additionalFields },\n      start_time: startTime,\n      end_time: endTime,\n      email_language: language,\n      timezone: timezone,\n    };\n  }\n\n  /**\n   * This is a custom event handler to book an event.\n   */\n  @Listen('detailsConfirmed')\n  async bookButtonClickedHandler(event: CustomEvent<NylasSchedulerBookingDataWithFlatFields>) {\n    if (event.defaultPrevented) {\n      return;\n    }\n    const bookingData = event.detail;\n    const mappedBookingData = this.mapToBookingData(bookingData);\n    this.bookingInfoConfirmed = bookingData;\n\n    const storeRescheduleId = this.nylasSchedulerConnector?.schedulerStore?.get('rescheduleBookingId');\n    const rescheduleBookingId = storeRescheduleId;\n    if (rescheduleBookingId) {\n      const result = await this.nylasSchedulerConnector?.scheduler.rescheduleBooking(rescheduleBookingId, bookingData);\n      if (!result || 'error' in result) {\n        this.nylasSchedulerError.emit({ notification: { ...this.getErrorObject(result?.error) }, host: this.host });\n      }\n      const resultData = (result as NylasSuccessResponse<NylasEvent>)?.data;\n      const bookedEventInfoEvent = this.bookedEventInfo.emit({ ...result, data: { ...resultData, ...mappedBookingData } });\n      if ('bookedEventInfo' in this.eventOverrides) {\n        await this.eventOverrides.bookedEventInfo(bookedEventInfoEvent, this.nylasSchedulerConnector);\n      }\n      return;\n    }\n    const result = await this.nylasSchedulerConnector?.scheduler.bookTimeslot(bookingData);\n    if (!result || 'error' in result) {\n      this.nylasSchedulerError.emit({ notification: { ...this.getErrorObject(result?.error) }, host: this.host });\n    }\n    const resultData = (result as NylasSuccessResponse<NylasEvent>)?.data;\n    const bookedEventInfoEvent = this.bookedEventInfo.emit({ ...result, data: { ...resultData, ...mappedBookingData } });\n    if ('bookedEventInfo' in this.eventOverrides) {\n      await this.eventOverrides.bookedEventInfo(bookedEventInfoEvent, this.nylasSchedulerConnector);\n    }\n  }\n\n  /**\n   * This is a custom event handler to update the selected date label.\n   */\n  @Listen('dateSelected')\n  dateSelectedHandler(event: CustomEvent<Date>) {\n    const date = event.detail;\n    this.selectedDateLabel = date ? date.toLocaleDateString(undefined, { dateStyle: 'full' }) : `${i18next.t('noDateSelected')}`;\n  }\n\n  /**\n   * This is an event handler to handle the error (if any) when the\n   * cancel booking button is clicked on the cancel booking form.\n   */\n  @Listen('cancelBookedEventError')\n  cancelBookedEventErrorHandler(event: CustomEvent<NylasSchedulerErrorResponse>) {\n    this.nylasSchedulerError.emit({ notification: { ...this.getErrorObject(event.detail.error) }, host: this.host });\n  }\n\n  @Listen('cancelBookedEventValidationError')\n  cancelBookedEventValidationErrorHandler(event: CustomEvent<NylasSchedulerErrorResponse>) {\n    this.nylasSchedulerError.emit({ notification: { ...this.getErrorObject(event.detail.error) }, host: this.host });\n  }\n\n  /**\n   * This is an event handler to handle the error (if any) when the\n   * reschedule button is clicked on the booked event card.\n   */\n  @Listen('rescheduleBookedEventError')\n  rescheduleBookedEventErrorHandler(event: CustomEvent<NylasSchedulerErrorResponse>) {\n    this.nylasSchedulerError.emit({ notification: { ...this.getErrorObject(event.detail.error) }, host: this.host });\n  }\n\n  /**\n   * This is an event handler to handle the error (if any) when the\n   * manual confirmation button is clicked on the manual confirmation card.\n   */\n  @Listen('confirmBookingError')\n  confirmBookingErrorHandler(event: CustomEvent<NylasSchedulerErrorResponse>) {\n    this.nylasSchedulerError.emit({ notification: { ...this.getErrorObject(event.detail.error) }, host: this.host });\n  }\n\n  @Listen('feedbackModalClosed')\n  feedbackModalClosedHandler() {\n    this.showFeedbackModal = false;\n  }\n\n  @Listen('feedbackSubmitted')\n  feedbackSubmittedHandler(event: CustomEvent<{ feedback: string }>) {\n    const eventId = Sentry.captureMessage('Scheduling Page User Feedback');\n    const feedback = {\n      eventId: eventId,\n      message: event.detail.feedback,\n    };\n    Sentry.captureFeedback(feedback, {\n      includeReplay: true,\n      captureContext: {\n        tags: {\n          'nylas-web-element': 'nylas-schduling',\n          'nylas-web-element-version': process.env.PACKAGE_VERSION,\n        },\n        extra: {\n          configId: this.configurationId,\n          slug: this.slug,\n        },\n      },\n    });\n    this.showFeedbackModal = false;\n  }\n\n  /**\n   * This method is used to retrieve the NylasScheduler instance\n   * @returns The NylasScheduler instance\n   */\n  @Method()\n  async getNylasSchedulerStore(): Promise<NylasSchedulerStoreType | undefined> {\n    return this.baseProvider?.getStore('scheduler');\n  }\n\n  /**\n   * This method is used to retrieve the NylasConnector instance\n   * @returns The NylasConnector instance\n   */\n  @Method()\n  async getNylasSchedulerConnector() {\n    return this.nylasSchedulerConnector;\n  }\n\n  @Method()\n  async getRef() {\n    return this.host;\n  }\n\n  private getErrorObject(error: NylasSchedulerErrorResponse['error']): Notification {\n    return {\n      title: error?.title || genericError.title,\n      category: error?.category || genericError.category,\n      type: NotificationType.Error,\n      description: error?.message || '',\n      id: new Date().getTime().toString(),\n      ttl: 'none',\n    };\n  }\n  private checkIfSessionIdOrConfigIdExists(): boolean {\n    if (!this.sessionId && !this.refConfigId && !(this.slug && this.clientId)) {\n      let description = '';\n\n      if (!this.sessionId) {\n        description += i18next.t('sessionIdRequiredErrorMessage');\n      }\n\n      if (!this.sessionId && !this.refConfigId && !(this.slug && this.clientId)) {\n        description = i18next.t('sessionIdRequiredErrorMessage') + ' ' + i18next.t('publicConfigErrorMessage');\n      }\n\n      this.nylasSchedulerError.emit({\n        notification: {\n          title: i18next.t('schedulingComponentErrorTitle'),\n          category: ErrorCategory.Component,\n          type: NotificationType.Error,\n          description: description,\n          id: new Date().getTime().toString(),\n          ttl: 'none',\n        },\n        host: this.host,\n      });\n      return false;\n    }\n    return true;\n  }\n\n  private isTimeslotValid(timeslot: Timeslot): boolean {\n    const selectedDate = new Date(timeslot.start_time);\n    if (selectedDate < new Date()) {\n      this.nylasSchedulerError.emit({\n        notification: {\n          title: i18next.t('invalidTimeslotErrorTitle'),\n          category: ErrorCategory.Component,\n          type: NotificationType.Error,\n          description: i18next.t('invalidTimeslotErrorMessage'),\n          id: new Date().getTime().toString(),\n          ttl: 'none',\n        },\n        host: this.host,\n      });\n      return false;\n    }\n    return true;\n  }\n\n  private validateAvailableDaysInFuture(\n    startDate: Date,\n    availableDaysInFuture: number,\n  ): {\n    startTime: number;\n    endTime: number;\n    endTimeForAvailableDaysInFuture: number;\n  } {\n    const today = new Date();\n    const startTime = new Date(startDate.getFullYear(), startDate.getMonth(), 1).getTime() / 1000;\n    const endTimeForCurrentMonth = new Date(startDate.getFullYear(), startDate.getMonth() + 1, 1).getTime() / 1000;\n    const endTimeForAvailableDaysInFuture = Math.floor(addDaysToCurrentDate(today, availableDaysInFuture).getTime() / 1000);\n    const endTime = Math.min(endTimeForAvailableDaysInFuture, endTimeForCurrentMonth);\n    const startTimeWithOffset = startTime < today.getTime() / 1000 ? Math.floor(today.getTime() / 1000) : startTime;\n    return { startTime: startTimeWithOffset, endTime, endTimeForAvailableDaysInFuture };\n  }\n\n  private applyThemeConfig(themeConfig?: ThemeConfig) {\n    if (themeConfig) {\n      for (const [key, value] of Object.entries(themeConfig)) {\n        this.host.style.setProperty(`${key}`, value);\n      }\n    }\n  }\n\n  onFeedbackClick(e: Event) {\n    e.preventDefault();\n    this.showFeedbackModal = true;\n  }\n\n  redirectToCustomUrl(url: string) {\n    window.location.assign(url);\n  }\n\n  /**\n   * @slot timeslot-picker-cta-label - This slot is used to pass a custom label to the timeslot picker CTA. The default label is \"Next\".\n   * @slot custom-booking-form - This slot is used to pass a custom booking form to the Nylas Scheduling component.\n   * @deprecated  Deprecated in favor of using the additional fields defined in the config settings.\n   */\n  render() {\n    const showDefaultScheduler = this.mode === 'app';\n    const nylasSchedulerStore = this.baseProvider?.getStore('scheduler');\n    const eventInfo = nylasSchedulerStore?.get('eventInfo');\n    const showBookingForm = nylasSchedulerStore?.get('showBookingForm');\n    const cancelledEventInfo = nylasSchedulerStore?.get('cancelledEventInfo');\n    const cancelBookingId = nylasSchedulerStore?.get('cancelBookingId');\n    const selectedTimeslot = nylasSchedulerStore?.get('selectedTimeslot') as Timeslot;\n    const rescheduleBookingId = nylasSchedulerStore?.get('rescheduleBookingId');\n    const organizerConfirmationBookingId = nylasSchedulerStore?.get('organizerConfirmationBookingId');\n    const rejectBookingId = nylasSchedulerStore?.get('rejectBookingId');\n    const confirmedEventInfo = nylasSchedulerStore?.get('confirmedEventInfo');\n    const nylasBranding = nylasSchedulerStore?.get('nylasBranding') || this.nylasBranding;\n    const selectedDate = nylasSchedulerStore?.get('selectedDate');\n    const redirectUrl = nylasSchedulerStore?.get('configSettings')?.scheduler?.confirmation_redirect_url;\n    this.selectedDateLabel =\n      selectedDate && this.language\n        ? capitalizeFirstLetter(selectedDate.toLocaleDateString(LANGUAGE_CODE_MAP[this.language], { dateStyle: 'full' }))\n        : `${i18next.t('noDateSelected')}`;\n\n    if (showDefaultScheduler && (cancelBookingId || rejectBookingId) && !cancelledEventInfo) {\n      return (\n        <Host>\n          <SchedulerView nylasBranding={nylasBranding} isLoading={this.isLoading} showNotification={this.showNotification}>\n            <div class=\"cancel-flow-page\" part=\"cancel-flow-page\">\n              <nylas-cancel-booking-form\n                selectedTimeslot={selectedTimeslot}\n                cancelBookingId={cancelBookingId}\n                rejectBookingId={rejectBookingId}\n                exportparts=\"ncbf, ncbf__icon, ncbf__title, ncbf__description, ncbf__reason-textarea, ncbf__button-cta, ncbf__button-outline, ncbf__card\"\n              />\n            </div>\n          </SchedulerView>\n          {this.enableUserFeedback && (\n            <button-component id=\"report-issue\" variant={'basic'} onClick={e => this.onFeedbackClick(e)}>\n              <feedback-icon />\n            </button-component>\n          )}\n          {this.showFeedbackModal && <nylas-feedback-form></nylas-feedback-form>}\n        </Host>\n      );\n    }\n\n    // Manual confirmation page is shown when the event is manually confirmed\n    if (showDefaultScheduler && organizerConfirmationBookingId) {\n      return (\n        <Host>\n          <SchedulerView>\n            <div class=\"manual-confirmation-page\" part=\"manual-confirmation-page\">\n              <nylas-organizer-confirmation-card\n                organizerConfirmationBookingId={organizerConfirmationBookingId}\n                exportparts=\"nmcc, nmcc__title, nmcc__description, nmcc__button-cta, nmcc__button-outline\"\n              />\n            </div>\n          </SchedulerView>\n          {this.enableUserFeedback && (\n            <button-component id=\"report-issue\" variant={'basic'} onClick={e => this.onFeedbackClick(e)}>\n              <feedback-icon />\n            </button-component>\n          )}\n          {this.showFeedbackModal && <nylas-feedback-form></nylas-feedback-form>}\n        </Host>\n      );\n    }\n\n    // Cancelled event card is shown when the event is cancelled\n    if (showDefaultScheduler && cancelledEventInfo) {\n      return (\n        <Host>\n          <SchedulerView nylasBranding={nylasBranding} isLoading={this.isLoading} showNotification={this.showNotification}>\n            <div class=\"cancelled-event-page\" part=\"cancelled-event-page\">\n              <nylas-cancelled-event-card\n                cancelledEventInfo={cancelledEventInfo}\n                exportparts=\"ncec, ncec__icon, ncec__title, ncec__description, ncec__button-outline, ncec__card\"\n              />\n            </div>\n          </SchedulerView>\n          {this.enableUserFeedback && (\n            <button-component id=\"report-issue\" variant={'basic'} onClick={e => this.onFeedbackClick(e)}>\n              <feedback-icon />\n            </button-component>\n          )}\n          {this.showFeedbackModal && <nylas-feedback-form></nylas-feedback-form>}\n        </Host>\n      );\n    }\n\n    // Confirmed event card is shown when the event is confirmed\n    if (showDefaultScheduler && confirmedEventInfo) {\n      return (\n        <Host>\n          <SchedulerView nylasBranding={nylasBranding} isLoading={this.isLoading} showNotification={this.showNotification}>\n            <div class=\"cancelled-event-page\" part=\"confirmed-event-page\">\n              <nylas-confirmed-event-card\n                confirmedEventInfo={confirmedEventInfo}\n                exportparts=\"ncec, ncec__icon, ncec__title, ncec__description, ncec__button-outline, ncec__card\"\n              />\n            </div>\n          </SchedulerView>\n          {this.enableUserFeedback && (\n            <button-component id=\"report-issue\" variant={'basic'} onClick={e => this.onFeedbackClick(e)}>\n              <feedback-icon />\n            </button-component>\n          )}\n          {this.showFeedbackModal && <nylas-feedback-form></nylas-feedback-form>}\n        </Host>\n      );\n    }\n\n    // Redirected to custom URL when the event is booked and redirect URL is provided\n    if (showDefaultScheduler && eventInfo && redirectUrl) {\n      const recipient = this.bookingInfoConfirmed?.primaryParticipant;\n      const additionalFields = this.bookingInfoConfirmed?.additionalFields || {};\n      if (this.bookingInfo && typeof this.bookingInfo?.additionalFields !== 'undefined') {\n        const bookingInfoAdditionalFields = this.bookingInfo.additionalFields;\n        // Merge additional fields from the bookingInfo with the additional fields from the booking form\n        Object.keys(bookingInfoAdditionalFields).forEach(key => {\n          if (!additionalFields[key] && bookingInfoAdditionalFields?.[key]) {\n            additionalFields[key] = bookingInfoAdditionalFields[key].value;\n          }\n        });\n      }\n      const selectedTimeslot = this.stores?.scheduler.get('selectedTimeslot');\n      const selectedTimezone = this.stores?.scheduler.get('selectedTimezone');\n      const selectedLanguage = this.stores?.scheduler.get('selectedLanguage');\n      const configSettings = this.stores?.scheduler.get('configSettings');\n\n      const configurationId = this.configurationId ? this.configurationId : configSettings?.configuration_id;\n      const queryString = window.location.search;\n\n      const urlParams = new URLSearchParams(queryString);\n      urlParams.set('booking_id', eventInfo.booking_id);\n      recipient?.name && urlParams.set('name', recipient.name);\n      recipient?.email && urlParams.set('email', recipient.email);\n      selectedTimeslot?.start_time && urlParams.set('start_time', (new Date(selectedTimeslot.start_time).getTime() / 1000).toString());\n      selectedTimeslot?.end_time && urlParams.set('end_time', (new Date(selectedTimeslot.end_time).getTime() / 1000).toString());\n      selectedTimezone && urlParams.set('tz', selectedTimezone);\n      selectedLanguage && urlParams.set('language', selectedLanguage);\n      additionalFields && urlParams.set('additional_values', JSON.stringify(additionalFields));\n      this.slug && urlParams.set('page_slug', this.slug);\n      configurationId && urlParams.set('config_id', configurationId);\n\n      this.redirectToCustomUrl(`${redirectUrl}?${urlParams.toString()}`);\n      return;\n    }\n\n    // Booked event card is shown when the event is booked or booking is sent\n    if (showDefaultScheduler && eventInfo) {\n      return (\n        <Host>\n          <SchedulerView nylasBranding={nylasBranding} isLoading={this.isLoading} showNotification={this.showNotification}>\n            <div class=\"booked-event-page\" part=\"booked-event-page\">\n              <nylas-booked-event-card\n                selectedTimeslot={selectedTimeslot}\n                eventInfo={eventInfo}\n                exportparts=\"nbec, nbec__title, nbec__card, nbec__description, nbec__button-outline, nbec__cancel-cta, nbec__reschedule-cta\"\n              />\n            </div>\n          </SchedulerView>\n          {this.enableUserFeedback && (\n            <button-component id=\"report-issue\" variant={'basic'} onClick={e => this.onFeedbackClick(e)}>\n              <feedback-icon />\n            </button-component>\n          )}\n          {this.showFeedbackModal && <nylas-feedback-form></nylas-feedback-form>}\n        </Host>\n      );\n    }\n    // Date and time picker is shown when the event is not booked and no additional data is shown\n    if (showDefaultScheduler && (!eventInfo || !!rescheduleBookingId) && !showBookingForm) {\n      const timeslotPickerCTALabel = this.host.querySelector('[slot=\"timeslot-picker-cta-label\"]');\n      return (\n        <Host>\n          <SchedulerView nylasBranding={nylasBranding} isLoading={this.isLoading} showNotification={this.showNotification}>\n            {rescheduleBookingId && <MessageBanner>{`${i18next.t('rescheduleTitle')}`}</MessageBanner>}\n            <div class=\"select-date-page\" part=\"select-date-page\">\n              <div class=\"left-panel\">\n                <nylas-date-picker exportparts=\"ndp, ndp__title, ndp__month-header, ndp__month-button, ndp__day, ndp__date, ndp__date--disabled, ndp__date--selected, ndp__date--current-day, ndp__date--current-month\"></nylas-date-picker>\n                <nylas-locale-switch exportparts=\"nls, nls__timezone, nls__timezone-dropdown, nls__timezone-drop-button, nls__timezone-drop-button-selected-label, nls__timezone-drop-content, nls__timezone-drop-label, nls__language, nls__language-dropdown, nls__language-drop-button, nls__language-drop-content, nls__language-drop-label\"></nylas-locale-switch>\n              </div>\n              <div class={`right-panel ${rescheduleBookingId ? 'reschedule' : ''}`}>\n                <h2>\n                  <calendar-icon></calendar-icon>\n                  <span id=\"selectedDate\">{this.selectedDateLabel}</span>\n                </h2>\n                <nylas-timeslot-picker exportparts=\"ntp, ntp__time-picker-wrapper, ntp__timeslots, ntp__timeslot, ntp__timeslot--selected, ntp__button-primary\">\n                  {timeslotPickerCTALabel && (\n                    <span slot=\"timeslot-picker-cta-label\">\n                      <slot name=\"timeslot-picker-cta-label\"></slot>\n                    </span>\n                  )}\n                </nylas-timeslot-picker>\n              </div>\n            </div>\n          </SchedulerView>\n          {this.enableUserFeedback && (\n            <button-component id=\"report-issue\" variant={'basic'} onClick={e => this.onFeedbackClick(e)}>\n              <feedback-icon />\n            </button-component>\n          )}\n          {this.showFeedbackModal && <nylas-feedback-form></nylas-feedback-form>}\n        </Host>\n      );\n    }\n    // Additional data is shown when the time is selected, event is not booked and additional data is shown\n    if (showDefaultScheduler && !eventInfo && showBookingForm) {\n      return (\n        <Host>\n          <SchedulerView nylasBranding={nylasBranding} isLoading={this.isLoading} showNotification={this.showNotification}>\n            {rescheduleBookingId && <MessageBanner>{`${i18next.t('rescheduleTitle')}`}</MessageBanner>}\n            <div class=\"additional-data-page\" part=\"additional-data-page\">\n              <div class=\"left-panel\">\n                <div class=\"wrapper\">\n                  <nylas-selected-event-card exportparts=\"nsec, nsec__card, nsec__icon, nsec__date, nsec__time, nsec__timezone\"></nylas-selected-event-card>\n                </div>\n              </div>\n              <div class={`right-panel ${rescheduleBookingId ? 'reschedule' : ''}`}>\n                <nylas-booking-form exportparts=\"nbf, nbf__input-textfield, nbf__button-ghost, nbf__button-outline, nbf__button-primary, nbf__input-wrapper, nbf__checkbox-component, nbf__radio-button-group, nbf__textarea-component, nbf__dropdown, nbf__dropdown-button, nbf__dropdown-content\"></nylas-booking-form>\n              </div>\n            </div>\n          </SchedulerView>\n          {this.enableUserFeedback && (\n            <button-component id=\"report-issue\" variant={'basic'} onClick={e => this.onFeedbackClick(e)}>\n              <feedback-icon />\n            </button-component>\n          )}\n          {this.showFeedbackModal && <nylas-feedback-form></nylas-feedback-form>}\n        </Host>\n      );\n    }\n\n    return (\n      <Host>\n        <slot />\n      </Host>\n    );\n  }\n}\n"],"mappings":"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"}